{% extends 'admin/base_site.html' %}
{% block content %}
    <a href="{% url 'admin:betting_match_add' %}" class="btn btn-success text-white float-lg-end">Add New Match</a>
    <h1>Work in progress</h1>
    {% for match in match_list %}
        <div style="margin-bottom: 100px">
            <div>
                {% csrf_token %}
                <label>
                    <input type="text" name="locked" value="true" hidden>
                </label>
                <div class="row">
                    <div class="col-sm">
                        <label class="required" for="id_game_name">Game name:</label>
                        <input name="game_name" required="" id="id_game_name" class="form-control"
                               value="{{ match.game_name }}"
                               readonly>
                    </div>
                    <div class="col-sm">
                        <label class="required" for="id_title">Match Title:</label>
                        <input type="text" name="title" value="{{ match.title }}" class="form-control" maxlength="255"
                               required="" id="id_title" readonly>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm">
                        <label for="start_date">Start date</label>
                        <input type="text" id="start_date" value="{{ match.start_time }}"
                               class="form-control" disabled></div>
                    <input type="date" name="start_time_0" value={{ match.start_time|date:"Y-m-d" }}
                            class="form-control" hidden>
                    <input type="time" name="start_time_1" value="{{ match.start_time|time:"H:i:s" }}"
                           class="form-control" hidden>
                    <div class="col-sm">
                        <label for="end_time_0">End date</label>
                        <input type="text" id="end_time_0" value="{{ match.end_time }}"
                               class="form-control" disabled></div>
                    <input type="date" name="end_time_0" value={{ match.end_time|date:"Y-m-d" }}
                            class="form-control" hidden>
                    <input type="time" name="end_time_1" value="{{ match.end_time|time:"H:i:s" }}"
                           class="form-control" hidden>
                </div>
                <a class="btn btn-success text-white"
                   href="{% url 'admin:betting_betscope_add' %}?match_id={{ match.id }}">
                    Add new bet Option
                </a>
                <a href="{% url 'admin:betting_match_change' match.id %}" class="btn btn-info text-white">Edit Match</a>
                {% if not match.is_locked %}
                    <a class="btn btn-danger float-end text-white" href="{% url 'admin:lock_match' match.id %}">Lock
                        Match</a>
                {% else %}
                    <button class="btn btn-danger float-end text-white disabled" disabled>Locked
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-lock-fill" viewBox="0 0 16 16">
                            <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                        </svg>
                    </button>
                {% endif %}
            </div>
            <div class="container">
                <h2>Bet option list</h2>
                {% for bet_scope in match.betscope_set.all %}
                    <table class="table table-striped table-light table-bordered">
                        <tr>
                            <th>Question</th>
                            <th>Option 1</th>
                            <th>Option 2</th>
                            <th>Option 3</th>
                            <th>Option 4</th>
                            <th>Action</th>
                        </tr>
                        <tr>
                            <td rowspan="2">{{ bet_scope.question }}</td>
                            <td>{{ bet_scope.option_1 }}</td>
                            <td>{{ bet_scope.option_2 }}</td>
                            <td>{{ bet_scope.option_3 }}</td>
                            <td>{{ bet_scope.option_4 }}</td>
                            {% if not bet_scope.is_locked %}
                                <td>
                                    <a href="{% url 'admin:lock_bet_scope' bet_scope.id "admin:match" %}"
                                       class="btn-sm btn-danger rounded-pill text-white">Lock</a>
                                </td>
                            {% else %}
                                <td>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                         class="bi bi-lock-fill" viewBox="0 0 16 16">
                                        <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                                    </svg>
                                </td>
                            {% endif %}
                        </tr>
                        <tr style="margin-bottom: 100px">
                            <td>{{ bet_scope.option_1_rate }}</td>
                            <td>{{ bet_scope.option_2_rate }}</td>
                            <td>{{ bet_scope.option_3_rate }}</td>
                            <td>{{ bet_scope.option_4_rate }}</td>
                            <td>
                                <a href="{% url 'admin:bet_scope_detail' bet_scope.id %}"
                                   class="btn-sm btn-success rounded-pill text-white">Detail</a>
                            </td>
                        </tr>
                    </table>
                {% empty %}
                    <p class="h1">No bet options for this match</p>
                {% endfor %}
            </div>
        </div>

    {% empty %}
        <p class="h1">No live match available</p>
    {% endfor %}
{% endblock %}